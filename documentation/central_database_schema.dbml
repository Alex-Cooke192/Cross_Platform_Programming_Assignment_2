// Central / Remote DB Schema
// Authoritative source of truth
// UUID primary keys stored as TEXT
// Timestamps stored as ISO-8601 TEXT

Table technicians_cache {
  id text [pk]
  username text [not null, unique]
  display_name text
  role text [not null, default: 'technician']

  created_at text [not null]
  updated_at text [not null]

  sync_status text [not null, default: 'synced', note: "CHECK IN ('synced','pending','conflict')"]
}

Table inspections {
  id text [pk]
  aircraft_id text [not null]

  opened_at text               // nullable
  completed_at text            // nullable

  technician_id text           // nullable FK -> technicians_cache.id

  created_at text [not null]
  updated_at text [not null]

  sync_status text [not null, default: 'synced', note: "CHECK IN ('synced','pending','conflict')"]
}

Table tasks {
  id text [pk]
  inspection_id text [not null] // FK -> inspections.id (ON DELETE CASCADE)

  title text [not null]
  description text

  is_complete int [not null, default: 0, note: "CHECK IN (0,1)"]
  result text
  notes text
  completed_at text

  created_at text [not null]
  updated_at text [not null]

  sync_status text [not null, default: 'synced', note: "CHECK IN ('synced','pending','conflict')"]

  Indexes {
    (inspection_id) [name: "idx_tasks_inspection_id"]
    (is_complete) [name: "idx_tasks_complete"]
  }
}

Ref: inspections.technician_id > technicians_cache.id [delete: set null]
Ref: tasks.inspection_id > inspections.id [delete: cascade]

